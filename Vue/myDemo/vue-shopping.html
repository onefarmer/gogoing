<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>vue-shopping</title>
    <script type="text/javascript" src="../assets/js/vue.min.js"></script>
    <style>
		* {margin: 0; padding: 0;}
		.box {width: 500px; padding: 20px;}
		li {background: #eee; list-style-type: none; margin: 15px 0; padding: 20px; position: relative;}
		button {padding: 5px 10px;}
		h4, p {margin: 5px 0;}

		.add {position: absolute; right: 20px; top: 20px;}
		.shopping_list {margin-top: 60px; border-top: 1px solid #999; position: relative; padding-top: 40px;}
		.shopping_list .delAll { position: absolute; top: 40px; right: 20px;}

		.price {position: absolute; top: 20px; right: 20px; font-size: 18px;}
		.wrap {margin-top: 20px;}
	</style>
</head>
<body>
    <h1>shopping</h1>
    <hr>
    <div id="app" class="box">
        <h2>菜单</h2>
        <ul>
            <li v-for = "(item,index) in menu">
                <h4>{{item.name}}</h4>
                <p>{{item.des}}</p>
                <p>价格：<span>{{item.price}}</span></p>
                <button class="add" @click='add(index)' v-bind:disabled="item.disabled">点餐</button>
            </li>
        </ul>
        <div class="shopping_list">
            <h2>购物车</h2>
            <p>总数：<span>{{totalNum()}}</span></p>
            <p>总额: <span>{{totalPrice()}}</span></p>
            <button class="delAll" @click="delAll">清空</button>
            <ul>
                <li v-for = "(val,index) in list">
                    <h4>{{val.name}}</h4>
                    <p class="price">价格：<span>{{val.price}}</span></p>
                    <div class="wrap">
                        <button @click="des(index)">-</button>
                        <span>{{val.num}}</span>
                        <button @click="val.num++">+</button>
                    </div>
                </li>
            </ul>
        </div>
    </div>
    <script type="text/javascript">
        var app = new Vue({
            el:'#app',
            data:{
                menu:[
                    {name:'宫保鸡丁',des:'肉太少了多加点',price:'30',disabled:false, id:0,num:1},
                    {name:'拍黄瓜',des:'醋放多了',price:'8',disabled:false, id:1,num:1},
                    {name:'花生米',des:'再来瓶勇闯天涯',price:'5',disabled:false, id:2,num:1}
                ],
                list:[]
            },
            methods:{
                add:function(i){
                    this.menu[i].disabled = true;
                    this.list.push(this.menu[i])
                },
                des:function(i){
                    this.list[i].num--;
                    if(this.list[i].num < 1){
                        //点餐按钮恢复可点击
                        this.menu[this.list[i].id].disabled = false;
                        //临时数组掏空
                        this.list.splice(i,1)
                    }
                },
                totalNum:function(){
                    var num = 0;
                    this.list.forEach(element => {
                        num += element.num;
                    });
                    return num
                },
                totalPrice:function(){
                    var price = 0;
                    this.list.forEach(item =>{
                        price += item.price*item.num;
                    })
                    return price
                },
                delAll:function(){
                    this.list = [];
                    this.menu.forEach(item=>{
                        item.disabled = false;
                    })
                }
            }
        })
    </script>
</body>
</html>