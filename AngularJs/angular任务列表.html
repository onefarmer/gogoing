<!DOCTYPE html>
<html>
	<head>
		<meta charset="UTF-8">
		<title></title>
		<script src="angular/angular.min.js" type="text/javascript" charset="utf-8"></script>
		<style type="text/css">
			form{margin: 10px;}
			.finished{margin: 10px;background: #EEEEEE;display: inline-block;padding: 0 5px;cursor: pointer;}
			*{padding: 0;margin: 0;}
			li{line-height: 50px;height: 50px;border-bottom: solid 1px #ccc;width: 500px;position: relative;}
			i{font-style: normal;position: absolute;right: 0;cursor: pointer;color: #0000CC;}
			.time{float: right;padding-right: 20px;}
			.last p{line-height: 24px;float: left;margin: 5px;}
			.last p em{color: #000;display: inline-block;background: #CCCC77;border-radius: 50%;
				text-align: center;font-style: normal;padding: 10px;margin: 0 5px;}
		</style>
	</head>
	<body ng-app = 'myApp' ng-controller = 'myCtrl' >
		<form>
			<h1>{{tlt}}</h1>
			<input ng-model = 'msg' type="text" placeholder="添加新任务" /><br /><br />
			<button ng-click="add()">添加</button><br /><br />
			<input type="checkbox"  ng-click="chooseAll()"/><span>标记所有为已解决</span><br />
			<span class="finished" ng-click="finishShow('no')">未完成</span>
			<span class="finished" ng-click="finishShow('yes')">已完成</span>
			<span class="finished" ng-click="finishShow()">全部</span>
			<ul>
				<li ng-repeat = 'item in things' ng-show="item.showbol">
					<input type="checkbox" ng-model = 'item.bol' ng-click="choose($index)"/>
					<span>{{item.content}}</span>
					<span class="time">{{item.time}}</span>
					<span class="time">{{item.date}}</span>
					<i ng-click="del($index)">X</i>
				</li>
			</ul>
			<div class="last">
				<p>未完成：<em>{{nofinish}}</em></p>
				<p>已完成：<em>{{finish}}</em></p>
				<p>总数：<em>{{things.length}}</em></p>
			</div>
		</form>
		
	</body>
</html>
<script type="text/javascript">
	var app = angular.module('myApp',[]).controller('myCtrl',function($scope){
		$scope.msg = '';
		$scope.tlt = '我的任务列表';
		$scope.things = [
			{content:'负分滚粗',date:'2017-1-01',time:'12:00:00',bol:false,showbol:true},
			{content:'一分拿滚',date:'2017-2-02',time:'13:00:00',bol:false,showbol:true},
			{content:'二分绕道',date:'2017-3-03',time:'14:00:00',bol:false,showbol:true},
			{content:'三分接稳',date:'2017-4-04',time:'15:00:00',bol:false,showbol:true}
		];
		$scope.nofinish = $scope.things.length;
		$scope.finish = $scope.things.length - $scope.nofinish ;
		$scope.choose = function(i){
			$scope.nofinish = 0;
			$scope.finish = 0;
			for(var i = 0;i < $scope.things.length;i++){
				if($scope.things[i].bol){
					$scope.finish += 1;
				}
			}
			$scope.nofinish = $scope.things.length - $scope.finish;
		};
		$scope.add = function(){
			if($scope.msg == ''){ return }
			$scope.date = new Date().toLocaleString().substr(0,8);
			$scope.time = new Date().toLocaleString().substring(12,19);
			$scope.things.push({content:$scope.msg,date:$scope.date,time:$scope.time,bol:false,showbol:true})
			$scope.msg =  '';
			$scope.choose()
		};
		$scope.del = function(i){
			$scope.things.splice(i,1);
			$scope.choose()
		};
		$scope.finishShow = function(val){
			for(var i=0;i<$scope.things.length;i++){
				$scope.things[i].showbol = true;
				if(val == 'no'){
					if($scope.things[i].bol){
						$scope.things[i].showbol = false;
					}						
				}
				else if(val == 'yes'){
					if(!$scope.things[i].bol){
						$scope.things[i].showbol = false;
					}						
				}
			}
		};
		$scope.onoff = true;
		$scope.chooseAll = function(){
			for(var i=0;i<$scope.things.length;i++){
				if($scope.onoff){
					$scope.things[i].bol = true;
				}
				else{
					$scope.things[i].bol = false;
				}
			}
			$scope.onoff = !$scope.onoff;
		}
	})
</script>