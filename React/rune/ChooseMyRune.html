<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Document</title>
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="https://cdn.staticfile.org/twitter-bootstrap/3.3.7/css/bootstrap.min.css">  
    <link href="select.css" rel="stylesheet" />
</head>
<body> 
    <div id="root"></div>
</body>
</html>
<script src="./react.js"></script>
<script src="./react-dom.js"></script>
<script src="./babel.js"></script>
<script type="text/babel">
    const rune = {
        jayce:[
            {type:'消耗Poke流派',imgUrl:'../../Public/images/ysw0.jpg'},
            {type:'一带一路',imgUrl:'../../Public/images/ysw1.jpg'},
            {type:'一套不解释带走',imgUrl:'../../Public/images/ysw2.jpg'},
        ],
        renekton:[
            {type:'能抗能打',imgUrl:'../../Public/images/ysw4.jpg'},
            {type:'全力输出',imgUrl:'../../Public/images/ysw5.jpg'},
            {type:'主肉副DPS',imgUrl:'../../Public/images/ysw6.jpg'},                  
        ]      
    }
    var ChooseMyRune = React.createClass({
        getInitialState(){
            return{
                // 杰斯，鳄鱼
                champion:['jayce','renekton'],
                list:rune.jayce,
                imgSrc:rune.jayce[0].imgUrl
            }
        },
        handleChoose(e){
            this.chooseRune();
        },
        chooseRune(){ 
            let championVal = this.refs.championVal.value;
            let data = rune[championVal];
            this.setState({
                list:data,
                imgSrc:data[0].imgUrl,              
            })   
        },
        handleRune(){
            let typeVal = this.refs.typeVal.value;
            let listType = this.state.list;
            let temp = '';
            listType.forEach((element,index) => {
                if(element.type.indexOf(typeVal)==0){
                    temp = element;
                }
            });
            this.setState({
                imgSrc:temp.imgUrl
            })
        },
        imgFn(){
            return <img src={this.state.imgSrc} ref='imgShow'/>
        },
        componentWillUpdate(){
            this.refs.imgShow.style.display = 'none'
        },
        componentDidUpdate(){
            setTimeout(() => {
                this.refs.imgShow.style.display = 'block' 
            }, 300);
        },
        render:function(){
            return(
                <div className="rune">
                    <select ref='championVal' onChange={this.handleChoose.bind(this)}>
                    {                       
                        this.state.champion.map( (item,index)=> {
                            return <option key={index}>{item}</option>
                        })                       
                    }
                    </select>
                    <select onChange = {this.handleRune.bind(this)} ref='typeVal'>
                    {                       
                       this.state.list.map( (item,index)=>{
                        return <option key={index}>{item.type}</option>
                       })
                    }                        
                    </select>
                    <br/>
                    <div className="wrap">
                        <h3>Choose Your's Rune</h3>
                        {this.imgFn()}
                    </div>
                </div>
            )
        }
    })
    ReactDOM.render(<ChooseMyRune/>,document.getElementById('root'))
</script>